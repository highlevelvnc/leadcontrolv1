<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LeadControl ‚Äî CRM Imobili√°rio</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="/css/style.css">
</head>
<body>

<!-- TOAST -->
<div class="toast" id="toast" style="display:none;">
  <span class="toast-icon" id="toastIcon">‚úÖ</span>
  <span id="toastMsg">A√ß√£o realizada!</span>
</div>

<!-- NOTIFICATIONS PANEL -->
<div class="notif-panel" id="notifPanel">
  <div class="notif-header">
    <span class="notif-title">Notifica√ß√µes</span>
    <span class="notif-mark" onclick="markAllRead()">Marcar lidas</span>
  </div>
  <div id="notifList"><div style="padding:20px;text-align:center;color:var(--text3);font-size:13px;">Carregando...</div></div>
</div>

<!-- MODAL: NOVO IM√ìVEL -->
<div class="modal-overlay" id="novoImovelModal">
  <div class="modal">
    <div class="modal-header">
      <span class="modal-title">Cadastrar Im√≥vel</span>
      <button class="modal-close" onclick="closeModal('novoImovelModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
      <div class="form-grid">
        <div class="form-group span2"><label class="form-label">T√≠tulo *</label><input class="form-input" id="propTitle" placeholder="Ex: Apartamento 3 Quartos ‚Äî Leblon"></div>
        <div class="form-group"><label class="form-label">Tipo *</label><select class="form-input" id="propType"><option value="apartamento">Apartamento</option><option value="casa">Casa</option><option value="cobertura">Cobertura</option><option value="studio">Studio</option><option value="flat">Flat</option><option value="penthouse">Penthouse</option><option value="sala_comercial">Sala Comercial</option><option value="terreno">Terreno</option></select></div>
        <div class="form-group"><label class="form-label">Finalidade *</label><select class="form-input" id="propPurpose"><option value="venda">Venda</option><option value="locacao">Loca√ß√£o</option></select></div>
        <div class="form-group"><label class="form-label">Pre√ßo *</label><input class="form-input" id="propPrice" placeholder="Ex: 1500000" type="number"></div>
        <div class="form-group"><label class="form-label">√Årea (m¬≤)</label><input class="form-input" id="propArea" placeholder="150" type="number"></div>
        <div class="form-group"><label class="form-label">Quartos</label><input class="form-input" id="propBedrooms" value="2" type="number" min="0"></div>
        <div class="form-group"><label class="form-label">Banheiros</label><input class="form-input" id="propBathrooms" value="2" type="number" min="0"></div>
        <div class="form-group"><label class="form-label">Vagas</label><input class="form-input" id="propParking" value="1" type="number" min="0"></div>
        <div class="form-group"><label class="form-label">Bairro</label><input class="form-input" id="propNeighborhood" placeholder="Ipanema"></div>
        <div class="form-group"><label class="form-label">Cidade</label><input class="form-input" id="propCity" placeholder="Rio de Janeiro"></div>
        <div class="form-group"><label class="form-label">Estado</label><input class="form-input" id="propState" placeholder="RJ"></div>
        <div class="form-group span2"><label class="form-label">URL da Foto Principal</label><input class="form-input" id="propImageUrl" placeholder="https://..."></div>
        <div class="form-group span2"><label class="form-label">Descri√ß√£o</label><textarea class="form-input" id="propDesc" rows="3" placeholder="Descreva o im√≥vel..."></textarea></div>
        <div class="form-group span2"><label class="form-label"><input type="checkbox" id="propFeatured" style="margin-right:8px;">Marcar como Destaque</label></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('novoImovelModal')">Cancelar</button>
      <button class="btn btn-primary" onclick="saveProperty()"><i class="fas fa-check"></i> Cadastrar</button>
    </div>
  </div>
</div>

<!-- MODAL: DETALHE IM√ìVEL -->
<div class="modal-overlay" id="propDetailModal">
  <div class="modal">
    <div class="modal-header">
      <span class="modal-title">Detalhes do Im√≥vel</span>
      <button class="modal-close" onclick="closeModal('propDetailModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" id="propDetailContent"></div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('propDetailModal')">Fechar</button>
    </div>
  </div>
</div>

<!-- MODAL: NOVO LEAD -->
<div class="modal-overlay" id="novoLeadModal">
  <div class="modal">
    <div class="modal-header">
      <span class="modal-title" id="leadModalTitle">Novo Lead</span>
      <button class="modal-close" onclick="closeModal('novoLeadModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
      <form id="novoLeadForm" onsubmit="return false;">
        <input type="hidden" id="leadEditId">
        <div class="form-grid">
          <div class="form-group"><label class="form-label">Nome *</label><input class="form-input" id="leadName" placeholder="Nome completo"></div>
          <div class="form-group"><label class="form-label">Telefone / WhatsApp</label><input class="form-input" id="leadPhone" placeholder="+55 (21) 9..." type="tel"></div>
          <div class="form-group span2"><label class="form-label">E-mail</label><input class="form-input" id="leadEmail" placeholder="email@exemplo.com" type="email"></div>
          <div class="form-group"><label class="form-label">Interesse</label><input class="form-input" id="leadInterest" placeholder="Ex: Apto 3q Ipanema"></div>
          <div class="form-group"><label class="form-label">Budget M√°x. (R$)</label><input class="form-input" id="leadBudget" placeholder="1500000" type="number"></div>
          <div class="form-group"><label class="form-label">Origem</label><select class="form-input" id="leadSource"><option value="manual">Manual</option><option value="zap_imoveis">Zap Im√≥veis</option><option value="olx">OLX</option><option value="instagram">Instagram</option><option value="indicacao">Indica√ß√£o</option><option value="site">Site pr√≥prio</option><option value="google_ads">Google Ads</option></select></div>
          <div class="form-group"><label class="form-label">Temperatura</label><select class="form-input" id="leadTemp"><option value="hot">üî• Quente</option><option value="warm">üå°Ô∏è Morno</option><option value="cold">‚ùÑÔ∏è Frio</option></select></div>
          <div class="form-group span2"><label class="form-label">Observa√ß√µes</label><textarea class="form-input" id="leadNotes" rows="3" placeholder="Notas sobre o cliente..."></textarea></div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('novoLeadModal')">Cancelar</button>
      <button class="btn btn-primary" onclick="saveLead()"><i class="fas fa-user-plus"></i> Salvar Lead</button>
    </div>
  </div>
</div>

<!-- MODAL: NOVO NEG√ìCIO -->
<div class="modal-overlay" id="newDealModal">
  <div class="modal" style="max-width:480px;">
    <div class="modal-header">
      <span class="modal-title">Novo Neg√≥cio</span>
      <button class="modal-close" onclick="closeModal('newDealModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
      <form id="newDealForm" onsubmit="return false;">
        <input type="hidden" id="dealStageId">
        <div class="form-grid">
          <div class="form-group span2"><label class="form-label">T√≠tulo *</label><input class="form-input" id="dealTitle" placeholder="Ex: Venda Cobertura ‚Äî Carlos"></div>
          <div class="form-group"><label class="form-label">Lead</label><select class="form-input" id="dealLeadId"></select></div>
          <div class="form-group"><label class="form-label">Im√≥vel</label><select class="form-input" id="dealPropId"></select></div>
          <div class="form-group"><label class="form-label">Valor (R$)</label><input class="form-input" id="dealValue" placeholder="1500000" type="number"></div>
          <div class="form-group"><label class="form-label">Previs√£o Fechamento</label><input class="form-input" id="dealClose" type="date"></div>
          <div class="form-group span2"><label class="form-label">Notas</label><textarea class="form-input" id="dealNotes" rows="2" placeholder="Detalhes do neg√≥cio..."></textarea></div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('newDealModal')">Cancelar</button>
      <button class="btn btn-primary" onclick="saveDeal()"><i class="fas fa-check"></i> Criar Neg√≥cio</button>
    </div>
  </div>
</div>

<!-- MODAL: AGENDAMENTO -->
<div class="modal-overlay" id="agendaModal">
  <div class="modal" style="max-width:480px;">
    <div class="modal-header">
      <span class="modal-title">Novo Agendamento</span>
      <button class="modal-close" onclick="closeModal('agendaModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
      <form id="agendaForm" onsubmit="return false;">
        <div class="form-grid">
          <div class="form-group span2"><label class="form-label">T√≠tulo *</label><input class="form-input" id="apptTitle" placeholder="Ex: Visita Cobertura Ipanema"></div>
          <div class="form-group"><label class="form-label">Tipo</label><select class="form-input" id="apptType"><option value="visit">Visita</option><option value="meeting">Reuni√£o</option><option value="signing">Assinatura</option><option value="call">Liga√ß√£o</option></select></div>
          <div class="form-group"><label class="form-label">Dura√ß√£o (min)</label><input class="form-input" id="apptDuration" value="60" type="number"></div>
          <div class="form-group span2"><label class="form-label">Data e Hora *</label><input class="form-input" id="apptDate" type="datetime-local"></div>
          <div class="form-group span2"><label class="form-label">Notas</label><textarea class="form-input" id="apptNotes" rows="2" placeholder="Observa√ß√µes..."></textarea></div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('agendaModal')">Cancelar</button>
      <button class="btn btn-primary" onclick="saveAppointment()"><i class="fas fa-calendar-check"></i> Agendar</button>
    </div>
  </div>
</div>

<!-- APP LAYOUT -->
<div class="app">
  <!-- SIDEBAR -->
  <nav class="sidebar">
    <div class="sidebar-logo">
      <div class="logo-icon"><i class="fas fa-building"></i></div>
      <div class="logo-text">Lead<span>Control</span></div>
    </div>
    <div class="sidebar-section-label">Principal</div>
    <div class="nav-item active" onclick="navigate('dashboard',this)"><i class="nav-icon fas fa-chart-pie"></i> Dashboard</div>
    <div class="nav-item" onclick="navigate('imoveis',this)"><i class="nav-icon fas fa-home"></i> Im√≥veis</div>
    <div class="nav-item" onclick="navigate('leads',this)"><i class="nav-icon fas fa-users"></i> Leads <span class="nav-badge red" id="leadsCount">‚Äî</span></div>
    <div class="nav-item" onclick="navigate('pipeline',this)"><i class="nav-icon fas fa-columns"></i> Pipeline</div>
    <div class="nav-item" onclick="navigate('agenda',this)"><i class="nav-icon fas fa-calendar-alt"></i> Agenda</div>
    <div class="sidebar-section-label">An√°lise</div>
    <div class="nav-item" onclick="navigate('relatorios',this)"><i class="nav-icon fas fa-chart-bar"></i> Relat√≥rios</div>
    <div class="nav-item" onclick="toast('Mapa dispon√≠vel em breve!')"><i class="nav-icon fas fa-map-marked-alt"></i> Mapa</div>
    <div class="nav-item" onclick="toast('Automa√ß√µes em breve!')"><i class="nav-icon fas fa-robot"></i> Automa√ß√µes <span class="nav-badge">Em breve</span></div>
    <div class="sidebar-bottom">
      <div class="agent-card" onclick="toast('Perfil em breve!')">
        <div class="agent-avatar" id="agentInitials">RS</div>
        <div class="agent-info">
          <div class="agent-name" id="agentName">Carregando...</div>
          <div class="agent-role" id="agentRole">CRM</div>
        </div>
        <div class="online-dot"></div>
      </div>
      <button onclick="logout()" style="width:100%;margin-top:8px;background:rgba(224,92,92,0.1);border:1px solid rgba(224,92,92,0.2);color:#e05c5c;border-radius:8px;padding:8px;font-size:12px;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all 0.2s;" onmouseover="this.style.background='rgba(224,92,92,0.2)'" onmouseout="this.style.background='rgba(224,92,92,0.1)'"><i class="fas fa-sign-out-alt"></i> Sair</button>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="main">
    <!-- TOPBAR -->
    <div class="topbar">
      <div>
        <div class="page-title" id="pageTitle">Dashboard</div>
        <div class="page-subtitle" id="pageSubtitle">Vis√£o geral do neg√≥cio</div>
      </div>
      <div class="topbar-right">
        <div class="search-box"><i class="fas fa-search" style="color:var(--text3);font-size:13px;"></i><input type="text" placeholder="Buscar..."></div>
        <div class="icon-btn" onclick="document.getElementById('notifPanel').classList.toggle('show');loadNotifications()"><i class="fas fa-bell"></i><span class="notif-dot" style="display:none;"></span></div>
        <button class="btn btn-primary" id="mainCta" onclick="openModal('novoImovelModal')"><i class="fas fa-plus"></i> Novo Im√≥vel</button>
      </div>
    </div>

    <div class="content">

      <!-- DASHBOARD -->
      <div class="view active" id="view-dashboard">
        <div class="kpi-grid">
          <div class="kpi-card gold"><div class="kpi-top"><div class="kpi-icon gold"><i class="fas fa-hand-holding-usd"></i></div><div class="kpi-trend up" id="kpi-vgv-trend">‚ñ≤ 0%</div></div><div class="kpi-value" id="kpi-vgv">‚Äî</div><div class="kpi-label">VGV ‚Äî M√™s Atual</div></div>
          <div class="kpi-card green"><div class="kpi-top"><div class="kpi-icon green"><i class="fas fa-user-check"></i></div><div class="kpi-trend up">‚óè Ativo</div></div><div class="kpi-value" id="kpi-leads">‚Äî</div><div class="kpi-label">Leads Ativos</div></div>
          <div class="kpi-card blue"><div class="kpi-top"><div class="kpi-icon blue"><i class="fas fa-home"></i></div><div class="kpi-trend up">‚óè Online</div></div><div class="kpi-value" id="kpi-properties">‚Äî</div><div class="kpi-label">Im√≥veis em Carteira</div></div>
          <div class="kpi-card purple"><div class="kpi-top"><div class="kpi-icon purple"><i class="fas fa-calendar-check"></i></div><div class="kpi-trend up">‚óè Este m√™s</div></div><div class="kpi-value" id="kpi-visits">‚Äî</div><div class="kpi-label">Visitas Agendadas</div></div>
        </div>
        <div class="main-grid">
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-star"></i> Im√≥veis em Destaque</div><button class="btn btn-ghost" style="padding:6px 14px;font-size:12px;" onclick="navigate('imoveis',null)">Ver todos</button></div>
            <div class="property-list" id="dash-properties"><div style="padding:20px;text-align:center;color:var(--text2)">Carregando...</div></div>
          </div>
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-fire"></i> Leads Quentes</div><button class="btn btn-ghost" style="padding:6px 14px;font-size:12px;" onclick="navigate('leads',null)">Ver todos</button></div>
            <div class="leads-list" id="dash-leads"><div style="padding:20px;text-align:center;color:var(--text2)">Carregando...</div></div>
          </div>
        </div>
        <div class="bottom-grid">
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-funnel-dollar"></i> Pipeline</div><span style="font-size:12px;color:var(--gold2);font-weight:600;" id="kpi-pipeline">‚Äî</span></div>
            <div class="pipeline" id="dash-pipeline"></div>
          </div>
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-chart-bar"></i> Vendas por M√™s</div></div>
            <div class="chart-area"><div class="mini-chart" id="monthlyChart"></div></div>
          </div>
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-bolt"></i> Atividades</div></div>
            <div class="activity-list" id="dash-activities"></div>
          </div>
        </div>
      </div>

      <!-- IM√ìVEIS -->
      <div class="view" id="view-imoveis">
        <div style="display:flex;gap:10px;align-items:center;margin-bottom:20px;flex-wrap:wrap;">
          <div class="search-box" style="flex:1;max-width:260px;"><i class="fas fa-search" style="color:var(--text3);font-size:13px;"></i><input type="text" id="imoveisSearch" placeholder="Buscar im√≥veis..." oninput="filterImoveis()"></div>
          <select class="form-input" id="imoveisType" style="width:140px;padding:9px 12px;font-size:13px;" onchange="filterImoveis()"><option value="">Todos os tipos</option><option value="apartamento">Apartamento</option><option value="casa">Casa</option><option value="cobertura">Cobertura</option><option value="studio">Studio</option><option value="penthouse">Penthouse</option></select>
          <select class="form-input" id="imoveisPurpose" style="width:130px;padding:9px 12px;font-size:13px;" onchange="filterImoveis()"><option value="">Venda/Loca√ß√£o</option><option value="venda">Venda</option><option value="locacao">Loca√ß√£o</option></select>
          <button class="btn btn-primary" onclick="openModal('novoImovelModal')"><i class="fas fa-plus"></i> Novo Im√≥vel</button>
        </div>
        <div class="imoveis-grid" id="imoveis-grid"></div>
      </div>

      <!-- LEADS -->
      <div class="view" id="view-leads">
        <div style="display:flex;gap:12px;align-items:center;margin-bottom:20px;flex-wrap:wrap;">
          <div class="search-box" style="flex:1;max-width:260px;"><i class="fas fa-search" style="color:var(--text3);font-size:13px;"></i><input type="text" id="leadsSearch" placeholder="Buscar leads..." oninput="filterLeads()"></div>
          <select class="form-input" id="leadsTemp" style="width:150px;padding:9px 12px;font-size:13px;" onchange="filterLeads()"><option value="">Todas temperaturas</option><option value="hot">üî• Quentes</option><option value="warm">üå°Ô∏è Mornos</option><option value="cold">‚ùÑÔ∏è Frios</option></select>
          <div style="margin-left:auto;display:flex;gap:10px;">
            <button class="btn btn-ghost" onclick="toast('Importa√ß√£o em breve!')"><i class="fas fa-file-import"></i> Importar CSV</button>
            <button class="btn btn-primary" onclick="openLeadModal()"><i class="fas fa-user-plus"></i> Novo Lead</button>
          </div>
        </div>
        <div class="panel">
          <table class="leads-table">
            <thead><tr><th>Cliente</th><th>Interesse</th><th>Origem</th><th>Score</th><th>Status</th><th>√öltimo Contato</th><th>A√ß√µes</th></tr></thead>
            <tbody id="leads-tbody"><tr><td colspan="7" style="text-align:center;padding:30px;color:var(--text2);">Carregando...</td></tr></tbody>
          </table>
        </div>
      </div>

      <!-- PIPELINE -->
      <div class="view" id="view-pipeline">
        <div style="margin-bottom:16px;display:flex;gap:12px;align-items:center;">
          <div style="font-size:14px;color:var(--text2);">Total em pipeline: <strong style="color:var(--gold2);" id="pipeline-total">‚Äî</strong></div>
          <div style="margin-left:auto;"><button class="btn btn-primary" onclick="openNewDeal(null)"><i class="fas fa-plus"></i> Novo Neg√≥cio</button></div>
        </div>
        <div style="overflow-x:auto;"><div class="kanban-cols" id="kanban-cols"><div style="padding:40px;color:var(--text2);">Carregando pipeline...</div></div></div>
      </div>

      <!-- AGENDA -->
      <div class="view" id="view-agenda">
        <div style="margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;">
          <div style="font-size:14px;color:var(--text2);">Semana atual</div>
          <button class="btn btn-primary" onclick="openAgendaModal()"><i class="fas fa-calendar-plus"></i> Agendar</button>
        </div>
        <div class="panel">
          <div class="panel-header"><div class="panel-title"><i class="icon fas fa-calendar-week"></i> Agenda da Semana</div></div>
          <div style="padding:20px;" id="agenda-list"><div style="text-align:center;color:var(--text2);padding:40px;">Carregando agenda...</div></div>
        </div>
      </div>

      <!-- RELAT√ìRIOS -->
      <div class="view" id="view-relatorios">
        <div class="reports-grid">
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-chart-bar"></i> Vendas por M√™s (R$)</div></div>
            <div class="chart-area"><div class="big-chart" id="bigChart"></div></div>
          </div>
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-filter"></i> Funil de Convers√£o</div></div>
            <div class="chart-area"><div class="funnel" id="funnelChart"></div></div>
          </div>
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-user-tie"></i> Equipe</div></div>
            <div class="chart-area" style="padding:12px;" id="agentRanking"></div>
          </div>
          <div class="panel">
            <div class="panel-header"><div class="panel-title"><i class="icon fas fa-tasks"></i> Tarefas Pendentes</div><button class="btn btn-primary" style="padding:6px 14px;font-size:12px;" onclick="toast('Tarefas em breve!')">Ver todas</button></div>
            <div style="padding:16px;color:var(--text2);font-size:13px;"><div style="padding:20px;text-align:center;">Dashboard de tarefas em desenvolvimento</div></div>
          </div>
        </div>
      </div>

    </div>
  </main>
</div>

<!-- AI ASSISTANT -->
<div class="ai-assistant">
  <div class="ai-chat" id="aiChat">
    <div class="ai-chat-header">
      <div class="ai-icon-pulse">‚ú®</div>
      <div><div class="ai-chat-name">Assistente IA</div><div class="ai-chat-status">‚óè Online</div></div>
      <div style="margin-left:auto;cursor:pointer;color:var(--text2);" onclick="toggleAI()"><i class="fas fa-times"></i></div>
    </div>
    <div class="ai-messages" id="aiMessages">
      <div class="ai-msg bot">Ol√°! üëã Sou seu assistente imobili√°rio com IA. Posso te ajudar com an√°lise de leads, sugest√µes de im√≥veis, propostas e muito mais!</div>
    </div>
    <div class="ai-input-wrap">
      <textarea class="ai-input" id="aiInput" rows="2" placeholder="Pergunte sobre leads, im√≥veis..."></textarea>
      <button class="ai-send" onclick="sendAIMessage()"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>
  <button class="ai-fab" onclick="toggleAI()">‚ú®</button>
</div>

<script src="/app.js"></script>
</body>
</html>
